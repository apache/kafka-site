<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>RemoteLogMetadataManager (kafka 3.1.2 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.apache.kafka.server.log.remote.storage, interface: RemoteLogMetadataManager">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.kafka.server.log.remote.storage</a></div>
<h1 title="Interface RemoteLogMetadataManager" class="title">Interface RemoteLogMetadataManager</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/AutoCloseable.html" title="class or interface in java.lang" class="external-link">AutoCloseable</a></code>, <code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/Closeable.html" title="class or interface in java.io" class="external-link">Closeable</a></code>, <code><a href="../../../../common/Configurable.html" title="interface in org.apache.kafka.common">Configurable</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="annotations"><a href="../../../../common/annotation/InterfaceStability.Evolving.html" title="annotation interface in org.apache.kafka.common.annotation">@Evolving</a>
</span><span class="modifiers">public interface </span><span class="element-name type-name-label">RemoteLogMetadataManager</span><span class="extends-implements">
extends <a href="../../../../common/Configurable.html" title="interface in org.apache.kafka.common">Configurable</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/Closeable.html" title="class or interface in java.io" class="external-link">Closeable</a></span></div>
<div class="block">This interface provides storing and fetching remote log segment metadata with strongly consistent semantics.
 <p>
 This class can be plugged in to Kafka cluster by adding the implementation class as
 <code>remote.log.metadata.manager.class.name</code> property value. There is an inbuilt implementation backed by
 topic storage in the local cluster. This is used as the default implementation if
 remote.log.metadata.manager.class.name is not configured.
 </p>
 <p>
 <code>remote.log.metadata.manager.class.path</code> property is about the class path of the RemoteLogStorageManager
 implementation. If specified, the RemoteLogStorageManager implementation and its dependent libraries will be loaded
 by a dedicated classloader which searches this class path before the Kafka broker class path. The syntax of this
 parameter is same with the standard Java class path string.
 </p>
 <p>
 <code>remote.log.metadata.manager.listener.name</code> property is about listener name of the local broker to which
 it should get connected if needed by RemoteLogMetadataManager implementation. When this is configured all other
 required properties can be passed as properties with prefix of 'remote.log.metadata.manager.listener.
 </p>
 "cluster.id", "broker.id" and all other properties prefixed with "remote.log.metadata." are passed when
 <a href="../../../../common/Configurable.html#configure(java.util.Map)"><code>Configurable.configure(Map)</code></a> is invoked on this instance.
 <p></div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#addRemoteLogSegmentMetadata(org.apache.kafka.server.log.remote.storage.RemoteLogSegmentMetadata)" class="member-name-link">addRemoteLogSegmentMetadata</a><wbr>(<a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteLogSegmentMetadata</a>&nbsp;remoteLogSegmentMetadata)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">This method is used to add <a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage"><code>RemoteLogSegmentMetadata</code></a> asynchronously with the containing <a href="RemoteLogSegmentId.html" title="class in org.apache.kafka.server.log.remote.storage"><code>RemoteLogSegmentId</code></a> into <a href="RemoteLogMetadataManager.html" title="interface in org.apache.kafka.server.log.remote.storage"><code>RemoteLogMetadataManager</code></a>.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#highestOffsetForEpoch(org.apache.kafka.common.TopicIdPartition,int)" class="member-name-link">highestOffsetForEpoch</a><wbr>(<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&nbsp;topicIdPartition,
 int&nbsp;leaderEpoch)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns the highest log offset of topic partition for the given leader epoch in remote storage.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Iterator.html" title="class or interface in java.util" class="external-link">Iterator</a>&lt;<a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteLogSegmentMetadata</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#listRemoteLogSegments(org.apache.kafka.common.TopicIdPartition)" class="member-name-link">listRemoteLogSegments</a><wbr>(<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&nbsp;topicIdPartition)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns all the remote log segment metadata of the given topicIdPartition.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Iterator.html" title="class or interface in java.util" class="external-link">Iterator</a>&lt;<a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteLogSegmentMetadata</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#listRemoteLogSegments(org.apache.kafka.common.TopicIdPartition,int)" class="member-name-link">listRemoteLogSegments</a><wbr>(<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&nbsp;topicIdPartition,
 int&nbsp;leaderEpoch)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns iterator of remote log segment metadata, sorted by <a href="RemoteLogSegmentMetadata.html#startOffset()"><code>RemoteLogSegmentMetadata.startOffset()</code></a> in
 ascending order which contains the given leader epoch.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#onPartitionLeadershipChanges(java.util.Set,java.util.Set)" class="member-name-link">onPartitionLeadershipChanges</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&gt;&nbsp;leaderPartitions,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&gt;&nbsp;followerPartitions)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">This method is invoked only when there are changes in leadership of the topic partitions that this broker is
 responsible for.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#onStopPartitions(java.util.Set)" class="member-name-link">onStopPartitions</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&gt;&nbsp;partitions)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">This method is invoked only when the topic partitions are stopped on this broker.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#putRemotePartitionDeleteMetadata(org.apache.kafka.server.log.remote.storage.RemotePartitionDeleteMetadata)" class="member-name-link">putRemotePartitionDeleteMetadata</a><wbr>(<a href="RemotePartitionDeleteMetadata.html" title="class in org.apache.kafka.server.log.remote.storage">RemotePartitionDeleteMetadata</a>&nbsp;remotePartitionDeleteMetadata)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">This method is used to update the metadata about remote partition delete event asynchronously.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteLogSegmentMetadata</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#remoteLogSegmentMetadata(org.apache.kafka.common.TopicIdPartition,int,long)" class="member-name-link">remoteLogSegmentMetadata</a><wbr>(<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&nbsp;topicIdPartition,
 int&nbsp;epochForOffset,
 long&nbsp;offset)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Returns <a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage"><code>RemoteLogSegmentMetadata</code></a> if it exists for the given topic partition containing the offset with
 the given leader-epoch for the offset, else returns <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html#empty()" title="class or interface in java.util" class="external-link"><code>Optional.empty()</code></a>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#updateRemoteLogSegmentMetadata(org.apache.kafka.server.log.remote.storage.RemoteLogSegmentMetadataUpdate)" class="member-name-link">updateRemoteLogSegmentMetadata</a><wbr>(<a href="RemoteLogSegmentMetadataUpdate.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteLogSegmentMetadataUpdate</a>&nbsp;remoteLogSegmentMetadataUpdate)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">This method is used to update the <a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage"><code>RemoteLogSegmentMetadata</code></a> asynchronously.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.io.Closeable">Methods inherited from interface&nbsp;java.io.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/Closeable.html" title="class or interface in java.io" class="external-link">Closeable</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/io/Closeable.html#close()" title="class or interface in java.io" class="external-link">close</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.apache.kafka.common.Configurable">Methods inherited from interface&nbsp;org.apache.kafka.common.<a href="../../../../common/Configurable.html" title="interface in org.apache.kafka.common">Configurable</a></h3>
<code><a href="../../../../common/Configurable.html#configure(java.util.Map)">configure</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="addRemoteLogSegmentMetadata(org.apache.kafka.server.log.remote.storage.RemoteLogSegmentMetadata)">
<h3>addRemoteLogSegmentMetadata</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">addRemoteLogSegmentMetadata</span><wbr><span class="parameters">(<a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteLogSegmentMetadata</a>&nbsp;remoteLogSegmentMetadata)</span>
                                             throws <span class="exceptions"><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></span></div>
<div class="block">This method is used to add <a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage"><code>RemoteLogSegmentMetadata</code></a> asynchronously with the containing <a href="RemoteLogSegmentId.html" title="class in org.apache.kafka.server.log.remote.storage"><code>RemoteLogSegmentId</code></a> into <a href="RemoteLogMetadataManager.html" title="interface in org.apache.kafka.server.log.remote.storage"><code>RemoteLogMetadataManager</code></a>.
 <p>
 RemoteLogSegmentMetadata is identified by RemoteLogSegmentId and it should have the initial state which is <a href="RemoteLogSegmentState.html#COPY_SEGMENT_STARTED"><code>RemoteLogSegmentState.COPY_SEGMENT_STARTED</code></a>.
 <p>
 <a href="#updateRemoteLogSegmentMetadata(org.apache.kafka.server.log.remote.storage.RemoteLogSegmentMetadataUpdate)"><code>updateRemoteLogSegmentMetadata(RemoteLogSegmentMetadataUpdate)</code></a> should be used to update an existing RemoteLogSegmentMetadata.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>remoteLogSegmentMetadata</code> - metadata about the remote log segment.</dd>
<dt>Returns:</dt>
<dd>a CompletableFuture which will complete once this operation is finished.</dd>
<dt>Throws:</dt>
<dd><code><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></code> - if there are any storage related errors occurred.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the given metadata instance does not have the state as <a href="RemoteLogSegmentState.html#COPY_SEGMENT_STARTED"><code>RemoteLogSegmentState.COPY_SEGMENT_STARTED</code></a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="updateRemoteLogSegmentMetadata(org.apache.kafka.server.log.remote.storage.RemoteLogSegmentMetadataUpdate)">
<h3>updateRemoteLogSegmentMetadata</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">updateRemoteLogSegmentMetadata</span><wbr><span class="parameters">(<a href="RemoteLogSegmentMetadataUpdate.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteLogSegmentMetadataUpdate</a>&nbsp;remoteLogSegmentMetadataUpdate)</span>
                                                throws <span class="exceptions"><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></span></div>
<div class="block">This method is used to update the <a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage"><code>RemoteLogSegmentMetadata</code></a> asynchronously. Currently, it allows to update with the new
 state based on the life cycle of the segment. It can go through the below state transitions.
 <p>
 <pre>
 +---------------------+            +----------------------+
 |COPY_SEGMENT_STARTED |-----------&gt;|COPY_SEGMENT_FINISHED |
 +-------------------+-+            +--+-------------------+
                     |                 |
                     |                 |
                     v                 v
                  +--+-----------------+-+
                  |DELETE_SEGMENT_STARTED|
                  +-----------+----------+
                              |
                              |
                              v
                  +-----------+-----------+
                  |DELETE_SEGMENT_FINISHED|
                  +-----------------------+
 </pre>
 <p>
 <a href="RemoteLogSegmentState.html#COPY_SEGMENT_STARTED"><code>RemoteLogSegmentState.COPY_SEGMENT_STARTED</code></a> - This state indicates that the segment copying to remote storage is started but not yet finished.
 <a href="RemoteLogSegmentState.html#COPY_SEGMENT_FINISHED"><code>RemoteLogSegmentState.COPY_SEGMENT_FINISHED</code></a> - This state indicates that the segment copying to remote storage is finished.
 <br>
 The leader broker copies the log segments to the remote storage and puts the remote log segment metadata with the
 state as “COPY_SEGMENT_STARTED” and updates the state as “COPY_SEGMENT_FINISHED” once the copy is successful.
 <p></p>
 <a href="RemoteLogSegmentState.html#DELETE_SEGMENT_STARTED"><code>RemoteLogSegmentState.DELETE_SEGMENT_STARTED</code></a> - This state indicates that the segment deletion is started but not yet finished.
 <a href="RemoteLogSegmentState.html#DELETE_SEGMENT_FINISHED"><code>RemoteLogSegmentState.DELETE_SEGMENT_FINISHED</code></a> - This state indicates that the segment is deleted successfully.
 <br>
 Leader partitions publish both the above delete segment events when remote log retention is reached for the
 respective segments. Remote Partition Removers also publish these events when a segment is deleted as part of
 the remote partition deletion.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>remoteLogSegmentMetadataUpdate</code> - update of the remote log segment metadata.</dd>
<dt>Returns:</dt>
<dd>a CompletableFuture which will complete once this operation is finished.</dd>
<dt>Throws:</dt>
<dd><code><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></code> - if there are any storage related errors occurred.</dd>
<dd><code><a href="RemoteResourceNotFoundException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteResourceNotFoundException</a></code> - when there are no resources associated with the given remoteLogSegmentMetadataUpdate.</dd>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/IllegalArgumentException.html" title="class or interface in java.lang" class="external-link">IllegalArgumentException</a></code> - if the given metadata instance has the state as <a href="RemoteLogSegmentState.html#COPY_SEGMENT_STARTED"><code>RemoteLogSegmentState.COPY_SEGMENT_STARTED</code></a></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="remoteLogSegmentMetadata(org.apache.kafka.common.TopicIdPartition,int,long)">
<h3>remoteLogSegmentMetadata</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteLogSegmentMetadata</a>&gt;</span>&nbsp;<span class="element-name">remoteLogSegmentMetadata</span><wbr><span class="parameters">(<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&nbsp;topicIdPartition,
 int&nbsp;epochForOffset,
 long&nbsp;offset)</span>
                                                     throws <span class="exceptions"><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></span></div>
<div class="block">Returns <a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage"><code>RemoteLogSegmentMetadata</code></a> if it exists for the given topic partition containing the offset with
 the given leader-epoch for the offset, else returns <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html#empty()" title="class or interface in java.util" class="external-link"><code>Optional.empty()</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>topicIdPartition</code> - topic partition</dd>
<dd><code>epochForOffset</code> - leader epoch for the given offset</dd>
<dd><code>offset</code> - offset</dd>
<dt>Returns:</dt>
<dd>the requested remote log segment metadata if it exists.</dd>
<dt>Throws:</dt>
<dd><code><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></code> - if there are any storage related errors occurred.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="highestOffsetForEpoch(org.apache.kafka.common.TopicIdPartition,int)">
<h3>highestOffsetForEpoch</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Optional.html" title="class or interface in java.util" class="external-link">Optional</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;</span>&nbsp;<span class="element-name">highestOffsetForEpoch</span><wbr><span class="parameters">(<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&nbsp;topicIdPartition,
 int&nbsp;leaderEpoch)</span>
                              throws <span class="exceptions"><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></span></div>
<div class="block">Returns the highest log offset of topic partition for the given leader epoch in remote storage. This is used by
 remote log management subsystem to know up to which offset the segments have been copied to remote storage for
 a given leader epoch.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>topicIdPartition</code> - topic partition</dd>
<dd><code>leaderEpoch</code> - leader epoch</dd>
<dt>Returns:</dt>
<dd>the requested highest log offset if exists.</dd>
<dt>Throws:</dt>
<dd><code><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></code> - if there are any storage related errors occurred.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="putRemotePartitionDeleteMetadata(org.apache.kafka.server.log.remote.storage.RemotePartitionDeleteMetadata)">
<h3>putRemotePartitionDeleteMetadata</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">putRemotePartitionDeleteMetadata</span><wbr><span class="parameters">(<a href="RemotePartitionDeleteMetadata.html" title="class in org.apache.kafka.server.log.remote.storage">RemotePartitionDeleteMetadata</a>&nbsp;remotePartitionDeleteMetadata)</span>
                                                  throws <span class="exceptions"><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></span></div>
<div class="block">This method is used to update the metadata about remote partition delete event asynchronously. Currently, it allows updating the
 state (<a href="RemotePartitionDeleteState.html" title="enum class in org.apache.kafka.server.log.remote.storage"><code>RemotePartitionDeleteState</code></a>) of a topic partition in remote metadata storage. Controller invokes
 this method with <a href="RemotePartitionDeleteMetadata.html" title="class in org.apache.kafka.server.log.remote.storage"><code>RemotePartitionDeleteMetadata</code></a> having state as <a href="RemotePartitionDeleteState.html#DELETE_PARTITION_MARKED"><code>RemotePartitionDeleteState.DELETE_PARTITION_MARKED</code></a>.
 So, remote partition removers can act on this event to clean the respective remote log segments of the partition.
 <p><br>
 In the case of default RLMM implementation, remote partition remover processes <a href="RemotePartitionDeleteState.html#DELETE_PARTITION_MARKED"><code>RemotePartitionDeleteState.DELETE_PARTITION_MARKED</code></a>
 <ul>
 <li> sends an event with state as <a href="RemotePartitionDeleteState.html#DELETE_PARTITION_STARTED"><code>RemotePartitionDeleteState.DELETE_PARTITION_STARTED</code></a>
 <li> gets all the remote log segments and deletes them.
 <li> sends an event with state as <a href="RemotePartitionDeleteState.html#DELETE_PARTITION_FINISHED"><code>RemotePartitionDeleteState.DELETE_PARTITION_FINISHED</code></a> once all the remote log segments are
 deleted.
 </ul></div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>remotePartitionDeleteMetadata</code> - update on delete state of a partition.</dd>
<dt>Returns:</dt>
<dd>a CompletableFuture which will complete once this operation is finished.</dd>
<dt>Throws:</dt>
<dd><code><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></code> - if there are any storage related errors occurred.</dd>
<dd><code><a href="RemoteResourceNotFoundException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteResourceNotFoundException</a></code> - when there are no resources associated with the given remotePartitionDeleteMetadata.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="listRemoteLogSegments(org.apache.kafka.common.TopicIdPartition)">
<h3>listRemoteLogSegments</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Iterator.html" title="class or interface in java.util" class="external-link">Iterator</a>&lt;<a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteLogSegmentMetadata</a>&gt;</span>&nbsp;<span class="element-name">listRemoteLogSegments</span><wbr><span class="parameters">(<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&nbsp;topicIdPartition)</span>
                                                  throws <span class="exceptions"><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></span></div>
<div class="block">Returns all the remote log segment metadata of the given topicIdPartition.
 <p>
 Remote Partition Removers uses this method to fetch all the segments for a given topic partition, so that they
 can delete them.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>Iterator of all the remote log segment metadata for the given topic partition.</dd>
<dt>Throws:</dt>
<dd><code><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="listRemoteLogSegments(org.apache.kafka.common.TopicIdPartition,int)">
<h3>listRemoteLogSegments</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Iterator.html" title="class or interface in java.util" class="external-link">Iterator</a>&lt;<a href="RemoteLogSegmentMetadata.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteLogSegmentMetadata</a>&gt;</span>&nbsp;<span class="element-name">listRemoteLogSegments</span><wbr><span class="parameters">(<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&nbsp;topicIdPartition,
 int&nbsp;leaderEpoch)</span>
                                                  throws <span class="exceptions"><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></span></div>
<div class="block">Returns iterator of remote log segment metadata, sorted by <a href="RemoteLogSegmentMetadata.html#startOffset()"><code>RemoteLogSegmentMetadata.startOffset()</code></a> in
 ascending order which contains the given leader epoch. This is used by remote log retention management subsystem
 to fetch the segment metadata for a given leader epoch.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>topicIdPartition</code> - topic partition</dd>
<dd><code>leaderEpoch</code> - leader epoch</dd>
<dt>Returns:</dt>
<dd>Iterator of remote segments, sorted by start offset in ascending order.</dd>
<dt>Throws:</dt>
<dd><code><a href="RemoteStorageException.html" title="class in org.apache.kafka.server.log.remote.storage">RemoteStorageException</a></code></dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="onPartitionLeadershipChanges(java.util.Set,java.util.Set)">
<h3>onPartitionLeadershipChanges</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">onPartitionLeadershipChanges</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&gt;&nbsp;leaderPartitions,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&gt;&nbsp;followerPartitions)</span></div>
<div class="block">This method is invoked only when there are changes in leadership of the topic partitions that this broker is
 responsible for.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>leaderPartitions</code> - partitions that have become leaders on this broker.</dd>
<dd><code>followerPartitions</code> - partitions that have become followers on this broker.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="onStopPartitions(java.util.Set)">
<h3>onStopPartitions</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">onStopPartitions</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Set.html" title="class or interface in java.util" class="external-link">Set</a>&lt;<a href="../../../../common/TopicIdPartition.html" title="class in org.apache.kafka.common">TopicIdPartition</a>&gt;&nbsp;partitions)</span></div>
<div class="block">This method is invoked only when the topic partitions are stopped on this broker. This can happen when a
 partition is emigrated to other broker or a partition is deleted.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>partitions</code> - topic partitions that have been stopped.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
