<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>ProducerInterceptor (kafka 3.8.1 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.apache.kafka.clients.producer, interface: ProducerInterceptor">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.kafka.clients.producer</a></div>
<h1 title="Interface ProducerInterceptor" class="title">Interface ProducerInterceptor&lt;K,<wbr>V&gt;</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Superinterfaces:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/AutoCloseable.html" title="class or interface in java.lang" class="external-link">AutoCloseable</a></code>, <code><a href="../../common/Configurable.html" title="interface in org.apache.kafka.common">Configurable</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public interface </span><span class="element-name type-name-label">ProducerInterceptor&lt;K,<wbr>V&gt;</span><span class="extends-implements">
extends <a href="../../common/Configurable.html" title="interface in org.apache.kafka.common">Configurable</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/AutoCloseable.html" title="class or interface in java.lang" class="external-link">AutoCloseable</a></span></div>
<div class="block">A plugin interface that allows you to intercept (and possibly mutate) the records received by the producer before
 they are published to the Kafka cluster.
 <p>
 This class will get producer config properties via <code>configure()</code> method, including clientId assigned
 by KafkaProducer if not specified in the producer config. The interceptor implementation needs to be aware that it will be
 sharing producer config namespace with other interceptors and serializers, and ensure that there are no conflicts.
 <p>
 Exceptions thrown by ProducerInterceptor methods will be caught, logged, but not propagated further. As a result, if
 the user configures the interceptor with the wrong key and value type parameters, the producer will not throw an exception,
 just log the errors.
 <p>
 ProducerInterceptor callbacks may be called from multiple threads. Interceptor implementation must ensure thread-safety, if needed.
 <p>
 Implement <a href="../../common/ClusterResourceListener.html" title="interface in org.apache.kafka.common"><code>ClusterResourceListener</code></a> to receive cluster metadata once it's available. Please see the class documentation for ClusterResourceListener for more information.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#close()" class="member-name-link">close</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">This is called when interceptor is closed</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#onAcknowledgement(org.apache.kafka.clients.producer.RecordMetadata,java.lang.Exception)" class="member-name-link">onAcknowledgement</a><wbr>(<a href="RecordMetadata.html" title="class in org.apache.kafka.clients.producer">RecordMetadata</a>&nbsp;metadata,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a>&nbsp;exception)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">This method is called when the record sent to the server has been acknowledged, or when sending the record fails before
 it gets sent to the server.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="ProducerRecord.html" title="class in org.apache.kafka.clients.producer">ProducerRecord</a>&lt;<a href="ProducerInterceptor.html" title="type parameter in ProducerInterceptor">K</a>,<wbr><a href="ProducerInterceptor.html" title="type parameter in ProducerInterceptor">V</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#onSend(org.apache.kafka.clients.producer.ProducerRecord)" class="member-name-link">onSend</a><wbr>(<a href="ProducerRecord.html" title="class in org.apache.kafka.clients.producer">ProducerRecord</a>&lt;<a href="ProducerInterceptor.html" title="type parameter in ProducerInterceptor">K</a>,<wbr><a href="ProducerInterceptor.html" title="type parameter in ProducerInterceptor">V</a>&gt;&nbsp;record)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">This is called from <a href="KafkaProducer.html#send(org.apache.kafka.clients.producer.ProducerRecord)"><code>KafkaProducer.send(ProducerRecord)</code></a> and
 <a href="KafkaProducer.html#send(org.apache.kafka.clients.producer.ProducerRecord,org.apache.kafka.clients.producer.Callback)"><code>KafkaProducer.send(ProducerRecord, Callback)</code></a> methods, before key and value
 get serialized and partition is assigned (if partition is not specified in ProducerRecord).</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.apache.kafka.common.Configurable">Methods inherited from interface&nbsp;org.apache.kafka.common.<a href="../../common/Configurable.html" title="interface in org.apache.kafka.common">Configurable</a></h3>
<code><a href="../../common/Configurable.html#configure(java.util.Map)">configure</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="onSend(org.apache.kafka.clients.producer.ProducerRecord)">
<h3>onSend</h3>
<div class="member-signature"><span class="return-type"><a href="ProducerRecord.html" title="class in org.apache.kafka.clients.producer">ProducerRecord</a>&lt;<a href="ProducerInterceptor.html" title="type parameter in ProducerInterceptor">K</a>,<wbr><a href="ProducerInterceptor.html" title="type parameter in ProducerInterceptor">V</a>&gt;</span>&nbsp;<span class="element-name">onSend</span><wbr><span class="parameters">(<a href="ProducerRecord.html" title="class in org.apache.kafka.clients.producer">ProducerRecord</a>&lt;<a href="ProducerInterceptor.html" title="type parameter in ProducerInterceptor">K</a>,<wbr><a href="ProducerInterceptor.html" title="type parameter in ProducerInterceptor">V</a>&gt;&nbsp;record)</span></div>
<div class="block">This is called from <a href="KafkaProducer.html#send(org.apache.kafka.clients.producer.ProducerRecord)"><code>KafkaProducer.send(ProducerRecord)</code></a> and
 <a href="KafkaProducer.html#send(org.apache.kafka.clients.producer.ProducerRecord,org.apache.kafka.clients.producer.Callback)"><code>KafkaProducer.send(ProducerRecord, Callback)</code></a> methods, before key and value
 get serialized and partition is assigned (if partition is not specified in ProducerRecord).
 <p>
 This method is allowed to modify the record, in which case, the new record will be returned. The implication of modifying
 key/value is that partition assignment (if not specified in ProducerRecord) will be done based on modified key/value,
 not key/value from the client. Consequently, key and value transformation done in onSend() needs to be consistent:
 same key and value should mutate to the same (modified) key and value. Otherwise, log compaction would not work
 as expected.
 <p>
 Similarly, it is up to interceptor implementation to ensure that correct topic/partition is returned in ProducerRecord.
 Most often, it should be the same topic/partition from 'record'.
 <p>
 Any exception thrown by this method will be caught by the caller and logged, but not propagated further.
 <p>
 Since the producer may run multiple interceptors, a particular interceptor's onSend() callback will be called in the order
 specified by <a href="ProducerConfig.html#INTERCEPTOR_CLASSES_CONFIG"><code>ProducerConfig.INTERCEPTOR_CLASSES_CONFIG</code></a>. The first interceptor
 in the list gets the record passed from the client, the following interceptor will be passed the record returned by the
 previous interceptor, and so on. Since interceptors are allowed to modify records, interceptors may potentially get
 the record already modified by other interceptors. However, building a pipeline of mutable interceptors that depend on the output
 of the previous interceptor is discouraged, because of potential side-effects caused by interceptors potentially failing to
 modify the record and throwing an exception. If one of the interceptors in the list throws an exception from onSend(), the exception
 is caught, logged, and the next interceptor is called with the record returned by the last successful interceptor in the list,
 or otherwise the client.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>record</code> - the record from client or the record returned by the previous interceptor in the chain of interceptors.</dd>
<dt>Returns:</dt>
<dd>producer record to send to topic/partition</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="onAcknowledgement(org.apache.kafka.clients.producer.RecordMetadata,java.lang.Exception)">
<h3>onAcknowledgement</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">onAcknowledgement</span><wbr><span class="parameters">(<a href="RecordMetadata.html" title="class in org.apache.kafka.clients.producer">RecordMetadata</a>&nbsp;metadata,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a>&nbsp;exception)</span></div>
<div class="block">This method is called when the record sent to the server has been acknowledged, or when sending the record fails before
 it gets sent to the server.
 <p>
 This method is generally called just before the user callback is called, and in additional cases when <code>KafkaProducer.send()</code>
 throws an exception.
 <p>
 Any exception thrown by this method will be ignored by the caller.
 <p>
 This method will generally execute in the background I/O thread, so the implementation should be reasonably fast.
 Otherwise, sending of messages from other threads could be delayed.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>metadata</code> - The metadata for the record that was sent (i.e. the partition and offset).
                 If an error occurred, metadata will contain only valid topic and maybe
                 partition. If partition is not given in ProducerRecord and an error occurs
                 before partition gets assigned, then partition will be set to RecordMetadata.NO_PARTITION.
                 The metadata may be null if the client passed null record to
                 <a href="KafkaProducer.html#send(org.apache.kafka.clients.producer.ProducerRecord)"><code>KafkaProducer.send(ProducerRecord)</code></a>.</dd>
<dd><code>exception</code> - The exception thrown during processing of this record. Null if no error occurred.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="close()">
<h3>close</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">close</span>()</div>
<div class="block">This is called when interceptor is closed</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/AutoCloseable.html#close()" title="class or interface in java.lang" class="external-link">close</a></code>&nbsp;in interface&nbsp;<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/AutoCloseable.html" title="class or interface in java.lang" class="external-link">AutoCloseable</a></code></dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
</div>
</div>
</body>
</html>
