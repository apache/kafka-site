<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc -->
<title>TokenBucket (kafka 2.7.0 API)</title>
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="TokenBucket (kafka 2.7.0 API)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/kafka/common/metrics/stats/Sum.html" title="class in org.apache.kafka.common.metrics.stats"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../org/apache/kafka/common/metrics/stats/Total.html" title="class in org.apache.kafka.common.metrics.stats"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/kafka/common/metrics/stats/TokenBucket.html" target="_top">Frames</a></li>
<li><a href="TokenBucket.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.apache.kafka.common.metrics.stats</div>
<h2 title="Class TokenBucket" class="title">Class TokenBucket</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.apache.kafka.common.metrics.stats.TokenBucket</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../../org/apache/kafka/common/metrics/Measurable.html" title="interface in org.apache.kafka.common.metrics">Measurable</a>, <a href="../../../../../../org/apache/kafka/common/metrics/MeasurableStat.html" title="interface in org.apache.kafka.common.metrics">MeasurableStat</a>, <a href="../../../../../../org/apache/kafka/common/metrics/MetricValueProvider.html" title="interface in org.apache.kafka.common.metrics">MetricValueProvider</a>&lt;<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Double.html?is-external=true" title="class or interface in java.lang">Double</a>&gt;, <a href="../../../../../../org/apache/kafka/common/metrics/Stat.html" title="interface in org.apache.kafka.common.metrics">Stat</a></dd>
</dl>
<hr>
<br>
<pre>public class <span class="typeNameLabel">TokenBucket</span>
extends <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="../../../../../../org/apache/kafka/common/metrics/MeasurableStat.html" title="interface in org.apache.kafka.common.metrics">MeasurableStat</a></pre>
<div class="block">The <a href="../../../../../../org/apache/kafka/common/metrics/stats/TokenBucket.html" title="class in org.apache.kafka.common.metrics.stats"><code>TokenBucket</code></a> is a <a href="../../../../../../org/apache/kafka/common/metrics/MeasurableStat.html" title="interface in org.apache.kafka.common.metrics"><code>MeasurableStat</code></a> implementing a token bucket algorithm
 that is usable within a <a href="../../../../../../org/apache/kafka/common/metrics/Sensor.html" title="class in org.apache.kafka.common.metrics"><code>Sensor</code></a>.

 The <a href="../../../../../../org/apache/kafka/common/metrics/Quota.html#bound--"><code>Quota.bound()</code></a> defined the refill rate of the bucket while the maximum burst or
 the maximum number of credits of the bucket is defined by
 <a href="../../../../../../org/apache/kafka/common/metrics/MetricConfig.html#samples--"><code>* MetricConfig#timeWindowMs() * Quota#bound()</code></a>.

 The quota is considered as exhausted when the amount of remaining credits in the bucket
 is below zero. The enforcement is done by the <a href="../../../../../../org/apache/kafka/common/metrics/Sensor.html" title="class in org.apache.kafka.common.metrics"><code>Sensor</code></a>.

 Token Bucket vs Rate based Quota:
 The current sampled rate based quota does not cope well with bursty workloads. The issue is
 that a unique and large sample can hold the average above the quota until it is discarded.
 Practically, when this happens, one must wait until the sample is expired to bring the rate
 below the quota even though less time would be theoretically required. As an examples, let's
 imagine that we have:
 - Quota (Q)   = 5
 - Samples (S) = 100
 - Window (W)  = 1s
 A burst of 560 brings the average rate (R) to 5.6 (560 / 100). The expected throttle time is
 computed as follow: ((R - Q / Q * S * W)) = ((5.6 - 5) / 5 * 100 * 1) = 12 secs. In practice,
 the average rate won't go below the quota before the burst is dropped from the samples so one
 must wait 100s (S * W).

 The token bucket relies on continuously updated amount of credits. Therefore, it does not
 suffers from the above issue. The same example would work as follow:
 - Quota (Q) = 5
 - Burst (B) = 5 * 1 * 100 = 500 (Q * S * W)
 A burst of 560 brings the amount of credits to -60. One must wait 12s (-(-60)/5) to refill the
 bucket to zero.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../org/apache/kafka/common/metrics/stats/TokenBucket.html#TokenBucket--">TokenBucket</a></span>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../../org/apache/kafka/common/metrics/stats/TokenBucket.html#TokenBucket-java.util.concurrent.TimeUnit-">TokenBucket</a></span>(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent">TimeUnit</a>&nbsp;unit)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>double</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/kafka/common/metrics/stats/TokenBucket.html#measure-org.apache.kafka.common.metrics.MetricConfig-long-">measure</a></span>(<a href="../../../../../../org/apache/kafka/common/metrics/MetricConfig.html" title="class in org.apache.kafka.common.metrics">MetricConfig</a>&nbsp;config,
       long&nbsp;timeMs)</code>
<div class="block">Measure this quantity and return the result as a double</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../../org/apache/kafka/common/metrics/stats/TokenBucket.html#record-org.apache.kafka.common.metrics.MetricConfig-double-long-">record</a></span>(<a href="../../../../../../org/apache/kafka/common/metrics/MetricConfig.html" title="class in org.apache.kafka.common.metrics">MetricConfig</a>&nbsp;config,
      double&nbsp;value,
      long&nbsp;timeMs)</code>
<div class="block">Record the given value</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/8/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="TokenBucket--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>TokenBucket</h4>
<pre>public&nbsp;TokenBucket()</pre>
</li>
</ul>
<a name="TokenBucket-java.util.concurrent.TimeUnit-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>TokenBucket</h4>
<pre>public&nbsp;TokenBucket(<a href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html?is-external=true" title="class or interface in java.util.concurrent">TimeUnit</a>&nbsp;unit)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="measure-org.apache.kafka.common.metrics.MetricConfig-long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>measure</h4>
<pre>public&nbsp;double&nbsp;measure(<a href="../../../../../../org/apache/kafka/common/metrics/MetricConfig.html" title="class in org.apache.kafka.common.metrics">MetricConfig</a>&nbsp;config,
                      long&nbsp;timeMs)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../../../org/apache/kafka/common/metrics/Measurable.html#measure-org.apache.kafka.common.metrics.MetricConfig-long-">Measurable</a></code></span></div>
<div class="block">Measure this quantity and return the result as a double</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/kafka/common/metrics/Measurable.html#measure-org.apache.kafka.common.metrics.MetricConfig-long-">measure</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/kafka/common/metrics/Measurable.html" title="interface in org.apache.kafka.common.metrics">Measurable</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>config</code> - The configuration for this metric</dd>
<dd><code>timeMs</code> - The POSIX time in milliseconds the measurement is being taken</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The measured value</dd>
</dl>
</li>
</ul>
<a name="record-org.apache.kafka.common.metrics.MetricConfig-double-long-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>record</h4>
<pre>public&nbsp;void&nbsp;record(<a href="../../../../../../org/apache/kafka/common/metrics/MetricConfig.html" title="class in org.apache.kafka.common.metrics">MetricConfig</a>&nbsp;config,
                   double&nbsp;value,
                   long&nbsp;timeMs)</pre>
<div class="block"><span class="descfrmTypeLabel">Description copied from interface:&nbsp;<code><a href="../../../../../../org/apache/kafka/common/metrics/Stat.html#record-org.apache.kafka.common.metrics.MetricConfig-double-long-">Stat</a></code></span></div>
<div class="block">Record the given value</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../../org/apache/kafka/common/metrics/Stat.html#record-org.apache.kafka.common.metrics.MetricConfig-double-long-">record</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../../org/apache/kafka/common/metrics/Stat.html" title="interface in org.apache.kafka.common.metrics">Stat</a></code></dd>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>config</code> - The configuration to use for this metric</dd>
<dd><code>value</code> - The value to record</dd>
<dd><code>timeMs</code> - The POSIX time in milliseconds this value occurred</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../org/apache/kafka/common/metrics/stats/Sum.html" title="class in org.apache.kafka.common.metrics.stats"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../../org/apache/kafka/common/metrics/stats/Total.html" title="class in org.apache.kafka.common.metrics.stats"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?org/apache/kafka/common/metrics/stats/TokenBucket.html" target="_top">Frames</a></li>
<li><a href="TokenBucket.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
